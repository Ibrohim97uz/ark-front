{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\Ibrohim\\\\Desktop\\\\ark-front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\Ibrohim\\\\Desktop\\\\ark-front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:\\\\Users\\\\Ibrohim\\\\Desktop\\\\ark-front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\Users\\\\Ibrohim\\\\Desktop\\\\ark-front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\Ibrohim\\\\Desktop\\\\ark-front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import _objectWithoutProperties from\"C:\\\\Users\\\\Ibrohim\\\\Desktop\\\\ark-front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectWithoutProperties\";var _excluded=[\"component\",\"authUser\"];import React,{Component}from\"react\";import{connect}from\"react-redux\";import URLSearchParams from'url-search-params';import{Redirect,Route,Switch}from\"react-router-dom\";import{ConfigProvider}from\"antd\";import{IntlProvider}from\"react-intl\";import AppLocale from\"locales\";import config from\"../../util/config\";import MainApp from\"./MainApp\";import Login from\"../../routes/login\";import NotFound404 from\"../../routes/404\";import ClientApp from\"./ClientApp\";import{onLayoutTypeChange,onNavStyleChange,setThemeType,updateState}from\"../../redux/setting/action\";import{onAuthUser}from\"../../redux/auth/action\";import{LAYOUT_TYPE_BOXED,LAYOUT_TYPE_FRAMED,LAYOUT_TYPE_FULL,NAV_STYLE_ABOVE_HEADER,NAV_STYLE_BELOW_HEADER,NAV_STYLE_DARK_HORIZONTAL,NAV_STYLE_DEFAULT_HORIZONTAL,NAV_STYLE_INSIDE_HEADER_HORIZONTAL}from\"../../constants/ThemeSetting\";import ApiRequest from\"../../services\";import api from\"../../services/app\";import{TOKEN_NAME}from\"../../util/constants\";var getResume=api.getResume,getSuggestionAndQuestion=api.getSuggestionAndQuestion,userMe=api.userMe;var openPages=config.openPages,adminPages=config.adminPages,moderatorPages=config.moderatorPages;var RestrictedRoute=function RestrictedRoute(_ref){var Component=_ref.component,authUser=_ref.authUser,rest=_objectWithoutProperties(_ref,_excluded);return/*#__PURE__*/React.createElement(Route,Object.assign({},rest,{render:function render(props){return/*#__PURE__*/React.createElement(Component,props);}}));};var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.setLayoutType=function(layoutType){if(layoutType===LAYOUT_TYPE_FULL){document.body.classList.remove('boxed-layout');document.body.classList.remove('framed-layout');document.body.classList.add('full-layout');}else if(layoutType===LAYOUT_TYPE_BOXED){document.body.classList.remove('full-layout');document.body.classList.remove('framed-layout');document.body.classList.add('boxed-layout');}else if(layoutType===LAYOUT_TYPE_FRAMED){document.body.classList.remove('boxed-layout');document.body.classList.remove('full-layout');document.body.classList.add('framed-layout');}};_this.setNavStyle=function(navStyle){if(navStyle===NAV_STYLE_DEFAULT_HORIZONTAL||navStyle===NAV_STYLE_DARK_HORIZONTAL||navStyle===NAV_STYLE_INSIDE_HEADER_HORIZONTAL||navStyle===NAV_STYLE_ABOVE_HEADER||navStyle===NAV_STYLE_BELOW_HEADER){document.body.classList.add('full-scroll');document.body.classList.add('horizontal-layout');}else{document.body.classList.remove('full-scroll');document.body.classList.remove('horizontal-layout');}};_this.getData=function(){_this.getInit();};_this.getUserMe=function(){ApiRequest(userMe).then(function(result){if(result.success){_this.props.onAuthUser(result.object);}else{_this.setState({auth:true});localStorage.removeItem(TOKEN_NAME);_this.props.onAuthUser(null);}});};_this.getInit=function(){ApiRequest(getResume).then(function(result){if(result.success){_this.props.updateState({resume:result.object});}});ApiRequest(getSuggestionAndQuestion).then(function(result){if(result.success){_this.props.updateState({suggestionAndQuestion:result.object});}});};_this.getInitPage=function(path){// if (path.includes('/login') && this.state.auth){\n//   return  <Route exact path={'/login'} component={Login}/>\n// }\nif(openPages.includes(path)||path.includes('/service/')||path.includes('/news/')||path.includes('/blog/')){return/*#__PURE__*/React.createElement(Route,{exact:true,path:'/**',component:ClientApp});}if(_this.props.authUser!==null&&_this.props.authUser.roles[0].name===\"ROLE_ADMIN\"&&adminPages.includes(path)+'||'+path.includes(\"/main/client/\")){return/*#__PURE__*/React.createElement(RestrictedRoute,{path:\"\".concat(_this.props.match.url),authUser:_this.props.authUser,component:MainApp});}if(_this.props.authUser!==null&&_this.props.authUser.roles[0].name===\"ROLE_MODERATOR\"&&moderatorPages.includes(path)+'||'+path.includes(\"/main/client/\")){return/*#__PURE__*/React.createElement(RestrictedRoute,{path:\"\".concat(_this.props.match.url),authUser:_this.props.authUser,component:MainApp});}if(_this.props.authUser===null&&path===\"/login\"&&!openPages.includes(path)+'&&'+(!path.includes('/service/')+'||'+!path.includes('/news/')+'||'+!path.includes('/blog/'))){return/*#__PURE__*/React.createElement(Route,{exact:true,path:path,component:NotFound404});}if(_this.props.authUser+'!=='+null&&!openPages.includes(path)+'&&'+(!path.includes('/service/')+'||'+!path.includes('/news/')+'||'+!path.includes('/blog/'))){return/*#__PURE__*/React.createElement(Route,{exact:true,path:path,component:NotFound404});}};_this.state={auth:false};_this.getInitPage=_this.getInitPage.bind(_assertThisInitialized(_this));return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){if(this.props.location.pathname===\"/login\"||adminPages.includes(this.props.location.pathname)||moderatorPages.includes(this.props.location.pathname)||this.props.location.pathname.includes(\"/main/client/\")){this.getUserMe();}if(this.props.location.pathname!==\"/login\"||adminPages.includes(this.props.location.pathname)||moderatorPages.includes(this.props.location.pathname)||this.props.location.pathname.includes(\"/main/client/\")){this.getData();}var params=new URLSearchParams(this.props.location.search);if(params.has(\"theme\")){this.props.setThemeType(params.get('theme'));}if(params.has(\"nav-style\")){this.props.onNavStyleChange(params.get('nav-style'));}if(params.has(\"layout-type\")){this.props.onLayoutTypeChange(params.get('layout-type'));}}},{key:\"render\",value:function render(){var _this$props=this.props,location=_this$props.location,layoutType=_this$props.layoutType,navStyle=_this$props.navStyle,locale=_this$props.locale,authUser=_this$props.authUser;if(authUser&&location.pathname==='/login'){return/*#__PURE__*/React.createElement(Redirect,{to:'/main/dashboard'});}if(location.pathname==='/'||location.pathname===''){return/*#__PURE__*/React.createElement(Redirect,{to:'/home'});}this.setLayoutType(layoutType);this.setNavStyle(navStyle);var currentAppLocale=AppLocale[locale.locale];return/*#__PURE__*/React.createElement(ConfigProvider,{locale:currentAppLocale.antd},/*#__PURE__*/React.createElement(IntlProvider,{locale:currentAppLocale.locale,messages:currentAppLocale.messages},/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(Route,{exact:true,path:'/login',component:Login}),this.getInitPage(location.pathname))));}}]);return App;}(Component);var mapStateToProps=function mapStateToProps(_ref2){var settings=_ref2.settings,auth=_ref2.auth;var locale=settings.locale,navStyle=settings.navStyle,layoutType=settings.layoutType;var authUser=auth.authUser,initURL=auth.initURL;return{locale:locale,navStyle:navStyle,layoutType:layoutType,authUser:authUser,initURL:initURL};};export default connect(mapStateToProps,{setThemeType:setThemeType,onNavStyleChange:onNavStyleChange,onLayoutTypeChange:onLayoutTypeChange,onAuthUser:onAuthUser,updateState:updateState})(App);","map":{"version":3,"sources":["C:/Users/Ibrohim/Desktop/ark-front/src/containers/App/index.js"],"names":["React","Component","connect","URLSearchParams","Redirect","Route","Switch","ConfigProvider","IntlProvider","AppLocale","config","MainApp","Login","NotFound404","ClientApp","onLayoutTypeChange","onNavStyleChange","setThemeType","updateState","onAuthUser","LAYOUT_TYPE_BOXED","LAYOUT_TYPE_FRAMED","LAYOUT_TYPE_FULL","NAV_STYLE_ABOVE_HEADER","NAV_STYLE_BELOW_HEADER","NAV_STYLE_DARK_HORIZONTAL","NAV_STYLE_DEFAULT_HORIZONTAL","NAV_STYLE_INSIDE_HEADER_HORIZONTAL","ApiRequest","api","TOKEN_NAME","getResume","getSuggestionAndQuestion","userMe","openPages","adminPages","moderatorPages","RestrictedRoute","component","authUser","rest","props","App","setLayoutType","layoutType","document","body","classList","remove","add","setNavStyle","navStyle","getData","getInit","getUserMe","then","result","success","object","setState","auth","localStorage","removeItem","resume","suggestionAndQuestion","getInitPage","path","includes","roles","name","match","url","state","bind","location","pathname","params","search","has","get","locale","currentAppLocale","antd","messages","mapStateToProps","settings","initURL"],"mappings":"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","sourcesContent":["import React, {Component} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport URLSearchParams from 'url-search-params'\r\nimport { Redirect, Route, Switch} from \"react-router-dom\";\r\nimport {ConfigProvider} from \"antd\";\r\nimport {IntlProvider} from \"react-intl\";\r\nimport AppLocale from \"locales\";\r\nimport config from \"../../util/config\"\r\nimport MainApp from \"./MainApp\";\r\nimport Login from \"../../routes/login\";\r\nimport NotFound404 from \"../../routes/404\";\r\nimport ClientApp from \"./ClientApp\";\r\nimport {onLayoutTypeChange, onNavStyleChange, setThemeType,updateState} from \"../../redux/setting/action\";\r\nimport {onAuthUser} from \"../../redux/auth/action\";\r\n\r\nimport {\r\n  LAYOUT_TYPE_BOXED,\r\n  LAYOUT_TYPE_FRAMED,\r\n  LAYOUT_TYPE_FULL,\r\n  NAV_STYLE_ABOVE_HEADER,\r\n  NAV_STYLE_BELOW_HEADER,\r\n  NAV_STYLE_DARK_HORIZONTAL,\r\n  NAV_STYLE_DEFAULT_HORIZONTAL,\r\n  NAV_STYLE_INSIDE_HEADER_HORIZONTAL\r\n} from \"../../constants/ThemeSetting\";\r\nimport ApiRequest from \"../../services\";\r\n\r\nimport api from \"../../services/app\"\r\nimport {TOKEN_NAME} from \"../../util/constants\";\r\nconst { getResume, getSuggestionAndQuestion,userMe} = api;\r\n\r\nconst {openPages, adminPages, moderatorPages} = config;\r\nconst RestrictedRoute = ({component: Component, authUser, ...rest}) => (\r\n  <Route{...rest} render={props => <Component {...props} />}/>);\r\n\r\n\r\nclass App extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    this.state={\r\n      auth:false\r\n    };\r\n    this.getInitPage = this.getInitPage.bind(this);\r\n  }\r\n\r\n  setLayoutType = (layoutType) => {\r\n    if (layoutType === LAYOUT_TYPE_FULL) {\r\n      document.body.classList.remove('boxed-layout');\r\n      document.body.classList.remove('framed-layout');\r\n      document.body.classList.add('full-layout');\r\n    } else if (layoutType === LAYOUT_TYPE_BOXED) {\r\n      document.body.classList.remove('full-layout');\r\n      document.body.classList.remove('framed-layout');\r\n      document.body.classList.add('boxed-layout');\r\n    } else if (layoutType === LAYOUT_TYPE_FRAMED) {\r\n      document.body.classList.remove('boxed-layout');\r\n      document.body.classList.remove('full-layout');\r\n      document.body.classList.add('framed-layout');\r\n    }\r\n  };\r\n\r\n  setNavStyle = (navStyle) => {\r\n    if (navStyle === NAV_STYLE_DEFAULT_HORIZONTAL ||\r\n      navStyle === NAV_STYLE_DARK_HORIZONTAL ||\r\n      navStyle === NAV_STYLE_INSIDE_HEADER_HORIZONTAL ||\r\n      navStyle === NAV_STYLE_ABOVE_HEADER ||\r\n      navStyle === NAV_STYLE_BELOW_HEADER) {\r\n      document.body.classList.add('full-scroll');\r\n      document.body.classList.add('horizontal-layout');\r\n    } else {\r\n      document.body.classList.remove('full-scroll');\r\n      document.body.classList.remove('horizontal-layout');\r\n    }\r\n  };\r\n\r\n  componentDidMount() {\r\n    if (this.props.location.pathname===\"/login\" || adminPages.includes(this.props.location.pathname) || moderatorPages.includes(this.props.location.pathname) || this.props.location.pathname.includes(\"/main/client/\") ){\r\n      this.getUserMe();\r\n    }\r\n    if (this.props.location.pathname!==\"/login\" || adminPages.includes(this.props.location.pathname) || moderatorPages.includes(this.props.location.pathname) || this.props.location.pathname.includes(\"/main/client/\") ){\r\n      this.getData();\r\n    }\r\n    const params = new URLSearchParams(this.props.location.search);\r\n\r\n    if (params.has(\"theme\")) {\r\n      this.props.setThemeType(params.get('theme'));\r\n    }\r\n    if (params.has(\"nav-style\")) {\r\n      this.props.onNavStyleChange(params.get('nav-style'));\r\n    }\r\n    if (params.has(\"layout-type\")) {\r\n      this.props.onLayoutTypeChange(params.get('layout-type'));\r\n    }\r\n\r\n  }\r\n\r\n  getData=()=>{\r\n      this.getInit()\r\n  }\r\n\r\n\r\n\r\n  getUserMe = () => {\r\n    ApiRequest(userMe).then((result) => {\r\n      if (result.success) {\r\n        this.props.onAuthUser(result.object);\r\n      } else {\r\n        this.setState({\r\n          auth:true\r\n        });\r\n        localStorage.removeItem(TOKEN_NAME);\r\n        this.props.onAuthUser(null);\r\n      }\r\n    })\r\n  };\r\n\r\n\r\n  getInit = () => {\r\n    ApiRequest(getResume).then((result) => {\r\n      if (result.success) {\r\n        this.props.updateState({resume:result.object});\r\n      }\r\n    });\r\n    ApiRequest(getSuggestionAndQuestion).then((result) => {\r\n      if (result.success) {\r\n        this.props.updateState({suggestionAndQuestion:result.object});\r\n      }\r\n    });\r\n  }\r\n\r\n  getInitPage = (path) => {\r\n    // if (path.includes('/login') && this.state.auth){\r\n    //   return  <Route exact path={'/login'} component={Login}/>\r\n    // }\r\n    if (openPages.includes(path) || path.includes('/service/') || path.includes('/news/') || path.includes('/blog/')) {\r\n      return   <Route exact path={'/**'} component={ClientApp}/>\r\n    }\r\n\r\n    if (this.props.authUser !== null && this.props.authUser.roles[0].name === \"ROLE_ADMIN\" &&  adminPages.includes(path) + '||'+  path.includes(\"/main/client/\")) {\r\n      return <RestrictedRoute path={`${this.props.match.url}`} authUser={this.props.authUser}\r\n                              component={MainApp}/>\r\n    }\r\n    if (this.props.authUser !== null &&  this.props.authUser.roles[0].name === \"ROLE_MODERATOR\" &&  moderatorPages.includes(path) + '||'+  path.includes(\"/main/client/\")) {\r\n      return <RestrictedRoute path={`${this.props.match.url}`} authUser={this.props.authUser}\r\n                              component={MainApp}/>\r\n    }\r\n\r\n    if (this.props.authUser === null && path===\"/login\" &&  !openPages.includes(path) + '&&'+  (!path.includes('/service/') + '||'+  !path.includes('/news/') + '||'+  !path.includes('/blog/'))) {\r\n      return <Route exact path={path} component={NotFound404}/>\r\n    }\r\n\r\n    if (this.props.authUser +'!=='+ null && !openPages.includes(path) + '&&'+  (!path.includes('/service/') + '||'+  !path.includes('/news/') + '||'+  !path.includes('/blog/'))) {\r\n      return <Route exact path={path} component={NotFound404}/>\r\n    }\r\n\r\n  };\r\n\r\n\r\n  render() {\r\n    const {location, layoutType, navStyle, locale,authUser} = this.props;\r\n    if (authUser && location.pathname==='/login'){\r\n      return <Redirect to={'/main/dashboard'}/>\r\n    }\r\n    if (location.pathname === '/' ||  location.pathname === '') {\r\n      return (<Redirect to={'/home'}/>);\r\n    }\r\n\r\n    this.setLayoutType(layoutType);\r\n\r\n    this.setNavStyle(navStyle);\r\n    const currentAppLocale = AppLocale[locale.locale];\r\n    return (\r\n      <ConfigProvider locale={currentAppLocale.antd}>\r\n        <IntlProvider\r\n          locale={currentAppLocale.locale}\r\n          messages={currentAppLocale.messages}>\r\n          <Switch>\r\n            <Route exact path={'/login'} component={Login}/>\r\n            {this.getInitPage(location.pathname)}\r\n          </Switch>\r\n        </IntlProvider>\r\n      </ConfigProvider>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = ({settings, auth}) => {\r\n  const {locale, navStyle, layoutType} = settings;\r\n  const {authUser, initURL} = auth;\r\n  return {locale, navStyle, layoutType, authUser, initURL}\r\n};\r\nexport default connect(mapStateToProps, {\r\n  setThemeType,\r\n  onNavStyleChange,\r\n  onLayoutTypeChange,\r\n  onAuthUser,\r\n  updateState\r\n})(App);\r\n"]},"metadata":{},"sourceType":"module"}