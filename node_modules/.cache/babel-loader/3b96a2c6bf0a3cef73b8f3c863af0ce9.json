{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\Ibrohim\\\\Desktop\\\\ark-front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _createForOfIteratorHelper from\"C:\\\\Users\\\\Ibrohim\\\\Desktop\\\\ark-front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createForOfIteratorHelper\";import _slicedToArray from\"C:\\\\Users\\\\Ibrohim\\\\Desktop\\\\ark-front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import axios from\"axios\";import{cloneDeep,isEmpty}from\"lodash\";import pathToRegexp from\"path-to-regexp\";import qs from\"qs\";import{TOKEN_NAME}from\"./constants\";var CancelToken=axios.CancelToken;window.cancelRequest=new Map();export default function request(options){var data=options.data,url=options.url,_options$method=options.method,method=_options$method===void 0?\"get\":_options$method;var cloneData=cloneDeep(data);try{var domain=\"\";var urlMatch=url.match(/[a-zA-z]+:\\/\\/[^/]*/);if(urlMatch){var _urlMatch=_slicedToArray(urlMatch,1);domain=_urlMatch[0];url=url.slice(domain.length);}var match=pathToRegexp.parse(url);url=pathToRegexp.compile(url)(data);var _iterator=_createForOfIteratorHelper(match),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var item=_step.value;if(item instanceof Object&&item.name in cloneData){delete cloneData[item.name];}}}catch(err){_iterator.e(err);}finally{_iterator.f();}url=domain+url;}catch(e){}data=data?data:{path:\"\"};options.url=method.toLocaleLowerCase()===\"get\"?data.path?\"\".concat(url).concat(isEmpty(cloneData)?\"\":\"/\").concat(cloneData.path):\"\".concat(url).concat(isEmpty(cloneData)?\"\":\"?\").concat(qs.stringify(cloneData)):url;if(method.toLocaleLowerCase()===\"delete\")options.url=method.toLocaleLowerCase()===\"delete\"?\"\".concat(url).concat(isEmpty(cloneData)?\"\":\"/\").concat(cloneData.id):url;if(method.toLocaleLowerCase()===\"put\"&&cloneData.path)options.url=\"\".concat(url).concat(isEmpty(cloneData)?\"\":\"/\").concat(cloneData.path);if(method.toLocaleLowerCase()===\"patch\"&&cloneData.path)options.url=\"\".concat(url).concat(isEmpty(cloneData)?\"\":\"/\").concat(cloneData.path);options.cancelToken=new CancelToken(function(cancel){window.cancelRequest.set(Symbol(Date.now()),{pathname:window.location.pathname,cancel:cancel});});axios.defaults.headers.common[\"Authorization\"]=localStorage.getItem(TOKEN_NAME);axios.defaults.baseURL=\"https://ark-logistics.herokuapp.com\";// axios.defaults.baseURL = \"https://ark-logistics.uz\";\ntry{if(data.fileUpload){options.headers={\"Content-Type\":\"multipart/form-data\"};var formData=new FormData();if(data.file.length>1){Array.from(data.file).forEach(function(file,i){formData.append(file.name,file.file[0]);});}else{formData.append(\"file\",data.file[0]);}delete data.file;formData.append(\"type\",data.type);Object.keys(data).forEach(function(i){return formData.append(i,data[i]);});options.data=formData;}}catch(e){}return axios(options).then(function(response){var statusText=response.statusText,status=response.status,data=response.data;var result={};if(typeof data===\"object\"){result=data;if(Array.isArray(data)){result.list=data;}}else{result.data=data;}return Promise.resolve(_objectSpread({success:true,message:statusText,statusCode:status},result));}).catch(function(error){var response=error.response;var msg;var statusCode;if(response&&response instanceof Object){var _data=response.data,statusText=response.statusText;statusCode=response.status;msg=_data.message||statusText;}else{statusCode=600;msg=error.message||\"Network Error\";}/* eslint-disable */return Promise.resolve({success:false,statusCode:statusCode,message:msg});});}","map":{"version":3,"sources":["C:/Users/Ibrohim/Desktop/ark-front/src/util/request.js"],"names":["axios","cloneDeep","isEmpty","pathToRegexp","qs","TOKEN_NAME","CancelToken","window","cancelRequest","Map","request","options","data","url","method","cloneData","domain","urlMatch","match","slice","length","parse","compile","item","Object","name","e","path","toLocaleLowerCase","stringify","id","cancelToken","cancel","set","Symbol","Date","now","pathname","location","defaults","headers","common","localStorage","getItem","baseURL","fileUpload","formData","FormData","file","Array","from","forEach","i","append","type","keys","then","response","statusText","status","result","isArray","list","Promise","resolve","success","message","statusCode","catch","error","msg"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport { cloneDeep, isEmpty } from \"lodash\";\r\nimport pathToRegexp from \"path-to-regexp\";\r\nimport qs from \"qs\";\r\nimport { TOKEN_NAME } from \"./constants\";\r\n\r\nconst { CancelToken } = axios;\r\nwindow.cancelRequest = new Map();\r\n\r\nexport default function request(options) {\r\n  let { data, url, method = \"get\" } = options;\r\n  let cloneData = cloneDeep(data);\r\n  try {\r\n    let domain = \"\";\r\n    const urlMatch = url.match(/[a-zA-z]+:\\/\\/[^/]*/);\r\n    if (urlMatch) {\r\n      [domain] = urlMatch;\r\n      url = url.slice(domain.length);\r\n    }\r\n\r\n    const match = pathToRegexp.parse(url);\r\n    url = pathToRegexp.compile(url)(data);\r\n\r\n    for (const item of match) {\r\n      if (item instanceof Object && item.name in cloneData) {\r\n        delete cloneData[item.name];\r\n      }\r\n    }\r\n    url = domain + url;\r\n  } catch (e) {}\r\n  data = data ? data : { path: \"\" };\r\n  options.url =\r\n    method.toLocaleLowerCase() === \"get\"\r\n      ? data.path\r\n        ? `${url}${isEmpty(cloneData) ? \"\" : \"/\"}${cloneData.path}`\r\n        : `${url}${isEmpty(cloneData) ? \"\" : \"?\"}${qs.stringify(cloneData)}`\r\n      : url;\r\n  if (method.toLocaleLowerCase() === \"delete\")\r\n    options.url =\r\n      method.toLocaleLowerCase() === \"delete\"\r\n        ? `${url}${isEmpty(cloneData) ? \"\" : \"/\"}${cloneData.id}`\r\n        : url;\r\n  if (method.toLocaleLowerCase() === \"put\" && cloneData.path)\r\n    options.url = `${url}${isEmpty(cloneData) ? \"\" : \"/\"}${cloneData.path}`;\r\n  if (method.toLocaleLowerCase() === \"patch\" && cloneData.path)\r\n    options.url = `${url}${isEmpty(cloneData) ? \"\" : \"/\"}${cloneData.path}`;\r\n  options.cancelToken = new CancelToken((cancel) => {\r\n    window.cancelRequest.set(Symbol(Date.now()), {\r\n      pathname: window.location.pathname,\r\n      cancel,\r\n    });\r\n  });\r\n  axios.defaults.headers.common[\"Authorization\"] =\r\n    localStorage.getItem(TOKEN_NAME);\r\n  axios.defaults.baseURL = \"https://ark-logistics.herokuapp.com\";\r\n  // axios.defaults.baseURL = \"https://ark-logistics.uz\";\r\n  try {\r\n    if (data.fileUpload) {\r\n      options.headers = {\r\n        \"Content-Type\": \"multipart/form-data\",\r\n      };\r\n      const formData = new FormData();\r\n      if (data.file.length > 1) {\r\n        Array.from(data.file).forEach((file, i) => {\r\n          formData.append(file.name, file.file[0]);\r\n        });\r\n      } else {\r\n        formData.append(\"file\", data.file[0]);\r\n      }\r\n      delete data.file;\r\n      formData.append(\"type\", data.type);\r\n      Object.keys(data).forEach((i) => formData.append(i, data[i]));\r\n      options.data = formData;\r\n    }\r\n  } catch (e) {}\r\n  return axios(options)\r\n    .then((response) => {\r\n      const { statusText, status, data } = response;\r\n      let result = {};\r\n      if (typeof data === \"object\") {\r\n        result = data;\r\n        if (Array.isArray(data)) {\r\n          result.list = data;\r\n        }\r\n      } else {\r\n        result.data = data;\r\n      }\r\n      return Promise.resolve({\r\n        success: true,\r\n        message: statusText,\r\n        statusCode: status,\r\n        ...result,\r\n      });\r\n    })\r\n    .catch((error) => {\r\n      const { response } = error;\r\n      let msg;\r\n      let statusCode;\r\n      if (response && response instanceof Object) {\r\n        const { data, statusText } = response;\r\n        statusCode = response.status;\r\n        msg = data.message || statusText;\r\n      } else {\r\n        statusCode = 600;\r\n        msg = error.message || \"Network Error\";\r\n      }\r\n      /* eslint-disable */\r\n      return Promise.resolve({\r\n        success: false,\r\n        statusCode,\r\n        message: msg,\r\n      });\r\n    });\r\n}\r\n"]},"metadata":{},"sourceType":"module"}