{"ast":null,"code":"import _defineProperty from\"C:\\\\Users\\\\Ibrohim\\\\Desktop\\\\ark-front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _classCallCheck from\"C:\\\\Users\\\\Ibrohim\\\\Desktop\\\\ark-front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\Ibrohim\\\\Desktop\\\\ark-front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\Ibrohim\\\\Desktop\\\\ark-front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\Ibrohim\\\\Desktop\\\\ark-front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from\"react\";import{Link,Redirect}from\"react-router-dom\";import{connect}from\"react-redux\";import firebase from'firebase/app';import{parsePhoneNumber}from'libphonenumber-js';import{MaskedInput}from\"antd-mask-input\";import{TOKEN_NAME}from\"util/constants\";import{Button,Col,Form,Input,Row,notification}from\"antd\";import ApiRequest from'../../services/index';import api from'../../services/app';import loginBack from'../../assets/images/ark-client/login-back.jpg';import{firebaseAuth}from'../../firebase/firebase';import IntlMessages,{intlMessages}from\"../../util/IntlMessages\";import{onAuthUser}from\"../../redux/auth/action\";var userCheckPhone=api.userCheckPhone,checkUser=api.checkUser,setPassword=api.setPassword,signIn=api.signIn,userMe=api.userMe;var Login=/*#__PURE__*/function(_React$Component){_inherits(Login,_React$Component);var _super=_createSuper(Login);function Login(props){var _this;_classCallCheck(this,Login);_this=_super.call(this,props);_this.recaptchaVerifier=null;_this.checkPhone=function(payload){ApiRequest(userCheckPhone,{phoneNumber:payload}).then(function(result){if(result.success){_this.setState({checkPhoneProcess:false,hasRegistered:result.hasRegistered,hasPassword:result.hasPassword,isAdmin:result.isAdmin,isLoading:false});}else{return/*#__PURE__*/React.createElement(Redirect,{to:'/login'});}});};_this.checkState=function(phoneNumber){try{if(parsePhoneNumber(phoneNumber).isValid()){_this.setState({isLoading:true});_this.checkPhone(phoneNumber);}else{_this.setState({checkPhoneProcess:true,hasRegistered:false});}}catch(e){_this.setState({checkPhoneProcess:true,hasRegistered:false});}};_this.checkUser=function(){var _this$state=_this.state,password=_this$state.password,phoneNumber=_this$state.phoneNumber;return ApiRequest(checkUser,{password:password,phoneNumber:phoneNumber});};_this.sign=function(payload){_this.setState({isLoading:true});if(!payload.hasPassword){var setPasswordBody={phoneNumber:payload.phoneNumber,password:payload.password,prePassword:payload.prePassword};ApiRequest(setPassword,setPasswordBody).then(function(res){if(res.success){_this.setState({hasPassword:true});}});_this.signInOrSignUp(payload);}else{_this.signInOrSignUp(payload);}};_this.signInOrSignUp=function(payload){var reqBody={};if(payload.hasRegistered){reqBody={phoneNumber:payload.phoneNumber,password:payload.password};}else{reqBody=payload;}ApiRequest(signIn,reqBody).then(function(data){_this.setState({verificationCode:''});if(data.body&&data.body.accessToken!==undefined){localStorage.setItem(TOKEN_NAME,data.body.tokenType+\" \"+data.body.accessToken);ApiRequest(userMe).then(function(result){if(result.success){_this.props.onAuthUser(result.object);_this.forceUpdate();}else{localStorage.removeItem(TOKEN_NAME);_this.props.onAuthUser(null);}});}}).finally(function(){_this.setState({isLoading:false});});};_this.state={phoneNumber:'',password:'',checkPhoneProcess:true,hasRegistered:false,reCaptcha:null,intervalId:'',confirmationResult:null,isVerifyProcess:false,code:'',lastName:'',confirmPassword:'',hasPassword:true,prePassword:'',isLoading:false,isAdmin:false};return _this;}_createClass(Login,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var cont=document.getElementById('reCaptcha');this.recaptchaVerifier=new firebase.auth.RecaptchaVerifier(cont,{'size':'invisible','callback':function callback(res){},'expired-callback':function expiredCallback(){},'error-callback':function errorCallback(){_this2.setState({isNotify:true,isLoading:false,toasterProps:{message:'Xatolik yuz berdi qaytadan urunib ko\\'ring'}});notification.warning({key:'warning',message:intlMessages({en:\"An error occurred. Please try again\",ru:\"Произошла ошибка. Пожалуйста, попробуйте еще раз\",uz:\"Xatolik yuz berdi qaytadan urunib ko'ring\"})});}});this.recaptchaVerifier.render();this.setState({reCaptcha:this.recaptchaVerifier});}},{key:\"render\",value:function render(){var _this3=this;// const {authUser} = this.props;\n// if (authUser){\n//   return <Redirect to={'/main/dashboard'}/>\n// }\nvar _this$state2=this.state,checkPhoneProcess=_this$state2.checkPhoneProcess,hasRegistered=_this$state2.hasRegistered,phoneNumber=_this$state2.phoneNumber,password=_this$state2.password,isLoading=_this$state2.isLoading,reCaptcha=_this$state2.reCaptcha,intervalId=_this$state2.intervalId,isVerifyProcess=_this$state2.isVerifyProcess,confirmationResult=_this$state2.confirmationResult,code=_this$state2.code,firstName=_this$state2.firstName,lastName=_this$state2.lastName,codeTime=_this$state2.codeTime,hasPassword=_this$state2.hasPassword,prePassword=_this$state2.prePassword,isAdmin=_this$state2.isAdmin;var updatePhone=function updatePhone(e){var _this3$setState;_this3.setState((_this3$setState={},_defineProperty(_this3$setState,e.target.name,e.target.value),_defineProperty(_this3$setState,\"isLoading\",false),_this3$setState));_this3.checkState(e.target.value);};var updateState=function updateState(e){var _this3$setState2;_this3.setState((_this3$setState2={},_defineProperty(_this3$setState2,e.target.name,e.target.value),_defineProperty(_this3$setState2,\"isLoading\",false),_this3$setState2));};var login=function login(e){e.preventDefault();if(hasRegistered&&hasPassword&&isAdmin){_this3.checkUser().then(function(res){if(res.success){// sendCode();\n_this3.signInOrSignUp({password:password,phoneNumber:phoneNumber});}else{notification.warning({key:'phoneNumber',message:\"Password\",description:\"Password warning\"});}});}else if(hasRegistered&&hasPassword&&!isAdmin){_this3.checkUser().then(function(res){if(res.success){_this3.signInOrSignUp({password:password,phoneNumber:phoneNumber});// this.sign({\n//     phoneNumber,\n//     password,\n//     hasRegistered,\n//     hasPassword,\n// })\n}else{notification.warning({key:'phoneNumber',message:intlMessages({en:\"Password\",ru:\"Пароль\",uz:\"Parol\"}),description:intlMessages({en:\"The password is incorrect\",ru:\"Пароль неправильный\",uz:\"Parol noto'g'ri\"})});}});}else{notification.warning({key:'phoneNumber',message:intlMessages({en:\"Phone number!\",ru:\"Номер телефона!\",uz:\"Telefon raqam!\"}),description:intlMessages({en:\"The phone number is incorrect\",ru:\"Номер телефона неверный\",uz:\"Telefon raqam noto'g'ri\"})});}};var sendCode=function sendCode(){_this3.setState({codeTime:60,isLoading:true});if(intervalId!=='')clearInterval(intervalId);firebaseAuth.signInWithPhoneNumber(phoneNumber,reCaptcha).then(function(result){var timeCount=60;_this3.setState({phoneNumber:phoneNumber,codeTime:timeCount,isVerifyProcess:true,confirmationResult:result,isLoading:false});var intervalId=setInterval(function(){timeCount--;_this3.setState({codeTime:timeCount>=0?timeCount:0});},1000);_this3.setState({intervalId:intervalId});}).catch(function(error){_this3.setState({isLoading:false});}).finally(function(){_this3.setState({isLoading:false});});};var checkVerificationCode=function checkVerificationCode(e){e.preventDefault();confirmationResult.confirm(code).then(function(res){_this3.sign({password:password,firstName:firstName,lastName:lastName,hasRegistered:hasRegistered,phoneNumber:phoneNumber,hasPassword:hasPassword,prePassword:prePassword});}).catch(function(error){notification.warning({key:'incorrect',message:intlMessages({en:\"Phone number!\",ru:\"Номер телефона!\",uz:\"Telefon raqam!\"}),description:intlMessages({en:\"The confirmation code is incorrect\",ru:\"Неверный код подтверждения\",uz:\"Tasdiqlash kodi noto'g'ri\"})});_this3.setState({isLoading:false});});};var cancelPhoneNubber=function cancelPhoneNubber(){_this3.setState({phoneNumber:'',isVerifyProcess:false,checkPhoneProcess:true});};if(!hasPassword){notification.error({key:'phoneNumber',message:intlMessages({en:\"Phone number!\",ru:\"Номер телефона!\",uz:\"Telefon raqam!\"}),description:intlMessages({en:\"Phone number not found this system\",ru:\"Номер телефона не найден этой системой\",uz:\"Tizimda bunday raqam topilmadi\"})});}return/*#__PURE__*/React.createElement(\"div\",{className:\"gx-app-login-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"gx-app-login-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"gx-app-login-main-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"gx-app-login-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"p-5 row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-12\"},/*#__PURE__*/React.createElement(Link,{to:'/home'},/*#__PURE__*/React.createElement(\"img\",{src:require(\"assets/images/ark-client/logo-black.png\"),alt:\"Logo\",height:100}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-12\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"font-weight-light title\"},\"\\\"\",/*#__PURE__*/React.createElement(IntlMessages,{id:\"page.login.app.title.one_top\"}),\"\\\"\",/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(IntlMessages,{id:\"page.login.app.title.one_bottom\"})),!isVerifyProcess?/*#__PURE__*/React.createElement(Form,{onSubmit:login,className:\"mt-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-block\"},/*#__PURE__*/React.createElement(\"h6\",{className:\"mb-5 sub-welcome\"},/*#__PURE__*/React.createElement(IntlMessages,{id:\"welcome\"})),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{span:4},/*#__PURE__*/React.createElement(\"div\",{className:\"icon-block\"},/*#__PURE__*/React.createElement(\"span\",{className:\"img-icon-phone\"}))),/*#__PURE__*/React.createElement(Col,{span:20,className:\"effect\"},/*#__PURE__*/React.createElement(MaskedInput,{mask:\"+998111111111\",placeholder:intlMessages({en:\"Enter your phone number\",ru:\"Введите номер телефона\",uz:\"Telefon raqamingizni kiriting\"}),className:\"form-control\",id:\"login\",name:\"phoneNumber\",onChange:updatePhone})))),!checkPhoneProcess&&hasRegistered&&hasPassword?/*#__PURE__*/React.createElement(\"div\",{className:\"form-block mb-0\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{span:4},/*#__PURE__*/React.createElement(\"div\",{className:\"icon-block\"},/*#__PURE__*/React.createElement(\"span\",{className:\"img-icon-key\"}))),/*#__PURE__*/React.createElement(Col,{span:20},/*#__PURE__*/React.createElement(Input.Password,{placeholder:intlMessages({en:\"Enter your password\",ru:\"Введите пароль\",uz:\"Parolni kiriting\"}),name:\"password\",id:\"password\",onChange:updateState}))),isLoading?/*#__PURE__*/React.createElement(\"div\",{style:{margin:\"0 auto\",width:\"35px\"}},/*#__PURE__*/React.createElement(\"div\",{className:\"my-loader\"})):/*#__PURE__*/React.createElement(Button,{type:\"default\",htmlType:\"submit\",className:\"btn-block\"},/*#__PURE__*/React.createElement(IntlMessages,{id:\"enter\"}))):''):/*#__PURE__*/React.createElement(Form,{onSubmit:checkVerificationCode,className:\"mt-5\"},/*#__PURE__*/React.createElement(\"h5\",{className:\"mb-4\"},/*#__PURE__*/React.createElement(IntlMessages,{id:\"confirm_code\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-block\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{span:4},/*#__PURE__*/React.createElement(\"div\",{className:\"icon-block text-center pt-2\",style:{fontSize:\"25px\"}},/*#__PURE__*/React.createElement(\"p\",{style:{margion:\"8px\"},className:\"mb-0\"},codeTime))),/*#__PURE__*/React.createElement(Col,{span:20},/*#__PURE__*/React.createElement(Input,{id:\"code\",placeholder:\"------\",name:\"code\",onChange:updateState,className:\"form-control\",value:code,required:true})))),/*#__PURE__*/React.createElement(\"h6\",{className:\"text-center font-change mb-0\"},/*#__PURE__*/React.createElement(IntlMessages,{id:\"send.sms\"})),/*#__PURE__*/React.createElement(\"h5\",{className:\"text-center font-change\"},\"+998 ** *** **\",phoneNumber.substring(11)),codeTime===0?/*#__PURE__*/React.createElement(Button,{onClick:sendCode,className:\"m-auto d-block bg-transparent border-0\"},/*#__PURE__*/React.createElement(IntlMessages,{id:\"resend.code\"})):'',isLoading?/*#__PURE__*/React.createElement(\"div\",{style:{margin:\"0 auto\",width:\"35px\"}},/*#__PURE__*/React.createElement(\"div\",{className:\"my-loader\"})):/*#__PURE__*/React.createElement(Row,{className:\"mt-4 back-next\"},/*#__PURE__*/React.createElement(Col,{span:12},/*#__PURE__*/React.createElement(Button,{htmlType:\"button\",type:\"default\",onClick:cancelPhoneNubber,className:\"pl-xl-5 pr-xl-5 pl-md-2 pr-md-2 pl-sm-1 pr-sm-1\"},/*#__PURE__*/React.createElement(IntlMessages,{id:\"cancel_code_btn\"}))),/*#__PURE__*/React.createElement(Col,{span:12},/*#__PURE__*/React.createElement(Button,{type:\"primary\",htmlType:\"submit\",className:\"float-right pl-xl-5 pr-xl-5 pl-md-2 pr-md-2 pl-sm-1 pr-sm-1\"},/*#__PURE__*/React.createElement(IntlMessages,{id:\"confirm_code_btn\"})))))),/*#__PURE__*/React.createElement(\"div\",{id:\"reCaptcha\",render:\"explicit\",style:{display:'none'}}))),/*#__PURE__*/React.createElement(\"div\",{className:\"gx-app-logo-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"gx-app-logo\"},/*#__PURE__*/React.createElement(\"img\",{alt:\"example\",src:loginBack}))))),/*#__PURE__*/React.createElement(\"div\",{id:\"reCaptcha\",render:\"explicit\",style:{display:'none'}}));}}]);return Login;}(React.Component);var mapStateToProps=function mapStateToProps(_ref){var auth=_ref.auth;var authUser=auth.authUser;return{authUser:authUser};};export default connect(mapStateToProps,{onAuthUser:onAuthUser})(Login);","map":{"version":3,"sources":["C:/Users/Ibrohim/Desktop/ark-front/src/routes/login/index.js"],"names":["React","Link","Redirect","connect","firebase","parsePhoneNumber","MaskedInput","TOKEN_NAME","Button","Col","Form","Input","Row","notification","ApiRequest","api","loginBack","firebaseAuth","IntlMessages","intlMessages","onAuthUser","userCheckPhone","checkUser","setPassword","signIn","userMe","Login","props","recaptchaVerifier","checkPhone","payload","phoneNumber","then","result","success","setState","checkPhoneProcess","hasRegistered","hasPassword","isAdmin","isLoading","checkState","isValid","e","state","password","sign","setPasswordBody","prePassword","res","signInOrSignUp","reqBody","data","verificationCode","body","accessToken","undefined","localStorage","setItem","tokenType","object","forceUpdate","removeItem","finally","reCaptcha","intervalId","confirmationResult","isVerifyProcess","code","lastName","confirmPassword","cont","document","getElementById","auth","RecaptchaVerifier","isNotify","toasterProps","message","warning","key","en","ru","uz","render","firstName","codeTime","updatePhone","target","name","value","updateState","login","preventDefault","description","sendCode","clearInterval","signInWithPhoneNumber","timeCount","setInterval","catch","error","checkVerificationCode","confirm","cancelPhoneNubber","require","margin","width","fontSize","margion","substring","display","Component","mapStateToProps","authUser"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { Link, Redirect } from \"react-router-dom\";\r\nimport {connect} from \"react-redux\";\r\nimport firebase from 'firebase/app';\r\nimport {parsePhoneNumber} from 'libphonenumber-js'\r\nimport {MaskedInput} from \"antd-mask-input\";\r\nimport {TOKEN_NAME} from \"util/constants\"\r\nimport {Button, Col, Form, Input, Row, notification} from \"antd\";\r\nimport ApiRequest from '../../services/index';\r\nimport api from '../../services/app';\r\nimport loginBack from '../../assets/images/ark-client/login-back.jpg'\r\nimport {firebaseAuth} from '../../firebase/firebase';\r\nimport IntlMessages, {intlMessages} from \"../../util/IntlMessages\";\r\nimport {onAuthUser} from \"../../redux/auth/action\"\r\n\r\nconst {userCheckPhone, checkUser, setPassword, signIn, userMe} = api;\r\n\r\nclass Login extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      phoneNumber: '',\r\n      password: '',\r\n      checkPhoneProcess: true,\r\n      hasRegistered: false,\r\n      reCaptcha: null,\r\n      intervalId: '',\r\n      confirmationResult: null,\r\n      isVerifyProcess: false,\r\n      code: '',\r\n      lastName: '',\r\n      confirmPassword: '',\r\n      hasPassword: true,\r\n      prePassword: '',\r\n      isLoading: false,\r\n      isAdmin: false,\r\n    }\r\n  }\r\n\r\n\r\n  recaptchaVerifier = null;\r\n\r\n  componentDidMount() {\r\n    let cont = document.getElementById('reCaptcha');\r\n    this.recaptchaVerifier = new firebase.auth.RecaptchaVerifier(cont, {\r\n      'size': 'invisible',\r\n      'callback': (res) => {\r\n      },\r\n      'expired-callback': () => {\r\n      },\r\n      'error-callback': () => {\r\n        this.setState({\r\n          isNotify: true,\r\n          isLoading: false,\r\n          toasterProps: {\r\n            message: 'Xatolik yuz berdi qaytadan urunib ko\\'ring'\r\n          }\r\n        });\r\n        notification.warning({\r\n          key: 'warning',\r\n          message: intlMessages({\r\n            en: \"An error occurred. Please try again\",\r\n            ru: \"Произошла ошибка. Пожалуйста, попробуйте еще раз\",\r\n            uz: \"Xatolik yuz berdi qaytadan urunib ko'ring\"\r\n          }),\r\n        });\r\n      }\r\n    });\r\n    this.recaptchaVerifier.render();\r\n    this.setState({\r\n      reCaptcha: this.recaptchaVerifier\r\n    })\r\n\r\n  }\r\n\r\n  checkPhone = (payload) => {\r\n    ApiRequest(userCheckPhone, {phoneNumber: payload}).then(result => {\r\n      if (result.success) {\r\n        this.setState({\r\n          checkPhoneProcess: false,\r\n          hasRegistered: result.hasRegistered,\r\n          hasPassword: result.hasPassword,\r\n          isAdmin: result.isAdmin,\r\n          isLoading: false\r\n        });\r\n      } else {\r\n        return <Redirect to={'/login'}/>\r\n      }\r\n    });\r\n\r\n  };\r\n  checkState = (phoneNumber) => {\r\n    try {\r\n      if (parsePhoneNumber(phoneNumber).isValid()) {\r\n        this.setState({isLoading: true});\r\n        this.checkPhone(phoneNumber);\r\n      } else {\r\n        this.setState({checkPhoneProcess: true, hasRegistered: false})\r\n      }\r\n    } catch (e) {\r\n      this.setState({checkPhoneProcess: true, hasRegistered: false})\r\n    }\r\n  };\r\n  checkUser = () => {\r\n    let {password, phoneNumber} = this.state;\r\n    return ApiRequest(checkUser, {password, phoneNumber})\r\n  };\r\n  sign = (payload) => {\r\n    this.setState({isLoading: true});\r\n    if (!payload.hasPassword) {\r\n      let setPasswordBody = {\r\n        phoneNumber: payload.phoneNumber,\r\n        password: payload.password,\r\n        prePassword: payload.prePassword\r\n      };\r\n      ApiRequest(setPassword, setPasswordBody).then(res => {\r\n        if (res.success) {\r\n          this.setState({hasPassword: true})\r\n        }\r\n      });\r\n      this.signInOrSignUp(payload)\r\n    } else {\r\n      this.signInOrSignUp(payload)\r\n    }\r\n  };\r\n  signInOrSignUp = (payload) => {\r\n    let reqBody = {};\r\n    if (payload.hasRegistered) {\r\n      reqBody = {phoneNumber: payload.phoneNumber, password: payload.password}\r\n    } else {\r\n      reqBody = payload\r\n    }\r\n    ApiRequest(signIn, reqBody).then((data) => {\r\n      this.setState({verificationCode: ''});\r\n      if (data.body && data.body.accessToken !== undefined) {\r\n        localStorage.setItem(TOKEN_NAME, data.body.tokenType + \" \" + data.body.accessToken);\r\n        ApiRequest(userMe).then((result) => {\r\n          if (result.success) {\r\n            this.props.onAuthUser(result.object);\r\n            this.forceUpdate();\r\n          } else {\r\n            localStorage.removeItem(TOKEN_NAME);\r\n            this.props.onAuthUser(null);\r\n          }\r\n        })\r\n      }\r\n    }).finally(() => {\r\n      this.setState({\r\n        isLoading: false\r\n      })\r\n    });\r\n  };\r\n\r\n  render() {\r\n    // const {authUser} = this.props;\r\n    // if (authUser){\r\n    //   return <Redirect to={'/main/dashboard'}/>\r\n    // }\r\n    const {\r\n      checkPhoneProcess, hasRegistered, phoneNumber, password, isLoading,\r\n      reCaptcha, intervalId, isVerifyProcess, confirmationResult,\r\n      code, firstName, lastName, codeTime, hasPassword, prePassword, isAdmin,\r\n    } = this.state;\r\n\r\n\r\n    const updatePhone = (e) => {\r\n      this.setState({\r\n        [e.target.name]: e.target.value,\r\n        isLoading: false\r\n      });\r\n      this.checkState(e.target.value)\r\n    };\r\n    const updateState = (e) => {\r\n      this.setState({\r\n        [e.target.name]: e.target.value,\r\n        isLoading: false\r\n      });\r\n    };\r\n\r\n    const login = (e) => {\r\n      e.preventDefault();\r\n      if (hasRegistered && hasPassword && isAdmin) {\r\n        this.checkUser().then(res => {\r\n          if (res.success) {\r\n            // sendCode();\r\n\r\n            this.signInOrSignUp({\r\n              password,\r\n              phoneNumber\r\n            })\r\n          } else {\r\n            notification.warning({\r\n              key: 'phoneNumber',\r\n              message: \"Password\",\r\n              description: \"Password warning\",\r\n            });\r\n          }\r\n        })\r\n      } else if (hasRegistered && hasPassword && !isAdmin) {\r\n        this.checkUser().then(res => {\r\n          if (res.success) {\r\n            this.signInOrSignUp({\r\n              password,\r\n              phoneNumber\r\n            })\r\n            // this.sign({\r\n            //     phoneNumber,\r\n            //     password,\r\n            //     hasRegistered,\r\n            //     hasPassword,\r\n            // })\r\n          } else {\r\n            notification.warning({\r\n              key: 'phoneNumber',\r\n              message: intlMessages({en: \"Password\", ru: \"Пароль\", uz: \"Parol\"}),\r\n              description: intlMessages({\r\n                en: \"The password is incorrect\",\r\n                ru: \"Пароль неправильный\",\r\n                uz: \"Parol noto'g'ri\"\r\n              }),\r\n            });\r\n          }\r\n        })\r\n      } else {\r\n        notification.warning({\r\n          key: 'phoneNumber',\r\n          message: intlMessages({en: \"Phone number!\", ru: \"Номер телефона!\", uz: \"Telefon raqam!\"}),\r\n          description: intlMessages({\r\n            en: \"The phone number is incorrect\",\r\n            ru: \"Номер телефона неверный\",\r\n            uz: \"Telefon raqam noto'g'ri\"\r\n          }),\r\n        });\r\n      }\r\n    };\r\n    const sendCode = () => {\r\n      this.setState({\r\n        codeTime: 60,\r\n        isLoading: true\r\n      });\r\n      if (intervalId !== '')\r\n        clearInterval(intervalId);\r\n      firebaseAuth.signInWithPhoneNumber(phoneNumber, reCaptcha)\r\n        .then((result) => {\r\n          let timeCount = 60;\r\n          this.setState({\r\n            phoneNumber,\r\n            codeTime: timeCount,\r\n            isVerifyProcess: true,\r\n            confirmationResult: result,\r\n            isLoading: false\r\n          });\r\n          let intervalId = setInterval(() => {\r\n            timeCount--;\r\n            this.setState({codeTime: timeCount >= 0 ? timeCount : 0})\r\n          }, 1000);\r\n          this.setState({\r\n            intervalId\r\n          })\r\n\r\n        })\r\n        .catch((error) => {\r\n          this.setState({\r\n            isLoading: false,\r\n          })\r\n        })\r\n        .finally(() => {\r\n          this.setState({\r\n            isLoading: false\r\n          })\r\n        });\r\n    };\r\n    const checkVerificationCode = (e) => {\r\n      e.preventDefault();\r\n      confirmationResult.confirm(code)\r\n        .then((res) => {\r\n          this.sign({\r\n            password,\r\n            firstName,\r\n            lastName,\r\n            hasRegistered,\r\n            phoneNumber: phoneNumber,\r\n            hasPassword,\r\n            prePassword\r\n          });\r\n\r\n        }).catch((error) => {\r\n        notification.warning({\r\n          key: 'incorrect',\r\n          message: intlMessages({en: \"Phone number!\", ru: \"Номер телефона!\", uz: \"Telefon raqam!\"}),\r\n          description: intlMessages({\r\n            en: \"The confirmation code is incorrect\",\r\n            ru: \"Неверный код подтверждения\",\r\n            uz: \"Tasdiqlash kodi noto'g'ri\"\r\n          }),\r\n        });\r\n        this.setState({\r\n          isLoading: false,\r\n        });\r\n      });\r\n    };\r\n\r\n    const cancelPhoneNubber = () => {\r\n      this.setState({\r\n        phoneNumber: '',\r\n        isVerifyProcess: false,\r\n        checkPhoneProcess: true\r\n      })\r\n    };\r\n\r\n    if (!hasPassword) {\r\n      notification.error({\r\n        key: 'phoneNumber',\r\n        message: intlMessages({en: \"Phone number!\", ru: \"Номер телефона!\", uz: \"Telefon raqam!\"}),\r\n        description: intlMessages({\r\n          en: \"Phone number not found this system\",\r\n          ru: \"Номер телефона не найден этой системой\",\r\n          uz: \"Tizimda bunday raqam topilmadi\"\r\n        }),\r\n      });\r\n    }\r\n\r\n    return (\r\n      <div className=\"gx-app-login-wrap\">\r\n        <div className=\"gx-app-login-container\">\r\n          <div className=\"gx-app-login-main-content\">\r\n            <div className=\"gx-app-login-content\">\r\n              <div className=\"p-5 row\">\r\n                <div className=\"col-md-12\">\r\n                  <Link to={'/home'}>\r\n                    <img src={require(\"assets/images/ark-client/logo-black.png\")} alt=\"Logo\" height={100}/>\r\n                  </Link>\r\n                </div>\r\n                <div className=\"col-md-12\">\r\n                  <h4 className=\"font-weight-light title\">\r\n                    \"<IntlMessages id=\"page.login.app.title.one_top\"/>\"<br/>\r\n                    <IntlMessages id=\"page.login.app.title.one_bottom\"/>\r\n                  </h4>\r\n                  {!isVerifyProcess ?\r\n                    <Form onSubmit={login} className=\"mt-5\">\r\n                      <div className=\"form-block\">\r\n                        <h6 className=\"mb-5 sub-welcome\">\r\n                          <IntlMessages id=\"welcome\"/>\r\n                        </h6>\r\n                        <Row>\r\n                          <Col span={4}>\r\n                            <div className=\"icon-block\">\r\n                              <span className=\"img-icon-phone\"/>\r\n                            </div>\r\n                          </Col>\r\n                          <Col span={20} className=\"effect\">\r\n                            <MaskedInput\r\n                              mask=\"+998111111111\"\r\n                              placeholder={intlMessages({\r\n                                en: \"Enter your phone number\",\r\n                                ru: \"Введите номер телефона\",\r\n                                uz: \"Telefon raqamingizni kiriting\"\r\n                              })}\r\n                              className=\"form-control\"\r\n                              id=\"login\"\r\n                              name=\"phoneNumber\"\r\n                              onChange={updatePhone}\r\n                            />\r\n                          </Col>\r\n                        </Row>\r\n                      </div>\r\n\r\n                      {!checkPhoneProcess && hasRegistered && hasPassword ?\r\n\r\n                        <div className=\"form-block mb-0\">\r\n                          <Row>\r\n                            <Col span={4}>\r\n                              <div className=\"icon-block\">\r\n                                <span className=\"img-icon-key\"/>\r\n                              </div>\r\n                            </Col>\r\n                            <Col span={20}>\r\n                              <Input.Password\r\n                                placeholder={intlMessages({\r\n                                  en: \"Enter your password\",\r\n                                  ru: \"Введите пароль\",\r\n                                  uz: \"Parolni kiriting\"\r\n                                })}\r\n                                name=\"password\"\r\n                                id=\"password\"\r\n                                onChange={updateState}\r\n\r\n                              />\r\n                            </Col>\r\n                          </Row>\r\n                          {isLoading ?\r\n                            <div style={{margin: \"0 auto\", width: \"35px\"}}>\r\n                              <div className=\"my-loader\"/>\r\n                            </div> :\r\n                            <Button type=\"default\" htmlType=\"submit\"\r\n                                    className=\"btn-block\"><IntlMessages\r\n                              id=\"enter\"/></Button>\r\n                          }\r\n                        </div>\r\n                        : ''}\r\n                    </Form>\r\n                    :\r\n                    <Form onSubmit={checkVerificationCode} className=\"mt-5\">\r\n                      <h5 className=\"mb-4\"><IntlMessages id=\"confirm_code\"/></h5>\r\n                      <div className=\"form-block\">\r\n                        <Row>\r\n                          <Col span={4}>\r\n                            <div className=\"icon-block text-center pt-2\"\r\n                                 style={{fontSize: \"25px\"}}>\r\n                              <p style={{margion: \"8px\"}} className=\"mb-0\">\r\n                                {codeTime}\r\n                              </p>\r\n                            </div>\r\n                          </Col>\r\n                          <Col span={20}>\r\n                            <Input id=\"code\"\r\n                                   placeholder=\"------\"\r\n                                   name=\"code\"\r\n                                   onChange={updateState}\r\n                                   className=\"form-control\" value={code} required\r\n                            />\r\n                          </Col>\r\n                        </Row>\r\n                      </div>\r\n                      <h6 className=\"text-center font-change mb-0\">\r\n                        <IntlMessages id=\"send.sms\"/>\r\n                      </h6>\r\n                      <h5 className=\"text-center font-change\">+998 ** ***\r\n                        **{phoneNumber.substring(11)}</h5>\r\n                      {codeTime === 0 ?\r\n                        <Button onClick={sendCode}\r\n                                className=\"m-auto d-block bg-transparent border-0\">\r\n                          <IntlMessages id=\"resend.code\"/>\r\n                        </Button> : ''}\r\n\r\n                      {isLoading ?\r\n                        <div style={{margin: \"0 auto\", width: \"35px\"}}>\r\n                          <div className=\"my-loader\"/>\r\n                        </div> :\r\n                        <Row className=\"mt-4 back-next\">\r\n                          <Col span={12}>\r\n                            <Button htmlType=\"button\" type=\"default\"\r\n                                    onClick={cancelPhoneNubber}\r\n                                    className=\"pl-xl-5 pr-xl-5 pl-md-2 pr-md-2 pl-sm-1 pr-sm-1\">\r\n                              <IntlMessages id=\"cancel_code_btn\"/>\r\n                            </Button>\r\n\r\n                          </Col>\r\n                          <Col span={12}>\r\n                            <Button type=\"primary\" htmlType=\"submit\"\r\n                                    className=\"float-right pl-xl-5 pr-xl-5 pl-md-2 pr-md-2 pl-sm-1 pr-sm-1\">\r\n                              <IntlMessages id=\"confirm_code_btn\"/></Button>\r\n                          </Col>\r\n                        </Row>\r\n                      }\r\n                    </Form>}\r\n                </div>\r\n                <div id=\"reCaptcha\" render=\"explicit\" style={{display: 'none'}}/>\r\n              </div>\r\n            </div>\r\n            <div className=\"gx-app-logo-content\">\r\n              <div className=\"gx-app-logo\">\r\n                <img alt=\"example\" src={loginBack}/>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div id=\"reCaptcha\" render=\"explicit\" style={{display: 'none'}}/>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n\r\nconst mapStateToProps = ({ auth}) => {\r\n  const {authUser} = auth;\r\n  return { authUser}\r\n};\r\nexport default connect(mapStateToProps, {onAuthUser})(Login);\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}