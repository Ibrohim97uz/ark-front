{"ast":null,"code":"import _objectSpread from \"C:\\\\Users\\\\Ibrohim\\\\Desktop\\\\ark-front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nimport _createForOfIteratorHelper from \"C:\\\\Users\\\\Ibrohim\\\\Desktop\\\\ark-front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createForOfIteratorHelper\";\nimport _slicedToArray from \"C:\\\\Users\\\\Ibrohim\\\\Desktop\\\\ark-front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nimport axios from \"axios\";\nimport { cloneDeep, isEmpty } from \"lodash\";\nimport pathToRegexp from \"path-to-regexp\";\nimport qs from \"qs\";\nimport { TOKEN_NAME } from \"./constants\";\nvar CancelToken = axios.CancelToken;\nwindow.cancelRequest = new Map();\nexport default function request(options) {\n  var data = options.data,\n      url = options.url,\n      _options$method = options.method,\n      method = _options$method === void 0 ? \"get\" : _options$method;\n  var cloneData = cloneDeep(data);\n\n  try {\n    var domain = \"\";\n    var urlMatch = url.match(/[a-zA-z]+:\\/\\/[^/]*/);\n\n    if (urlMatch) {\n      var _urlMatch = _slicedToArray(urlMatch, 1);\n\n      domain = _urlMatch[0];\n      url = url.slice(domain.length);\n    }\n\n    var match = pathToRegexp.parse(url);\n    url = pathToRegexp.compile(url)(data);\n\n    var _iterator = _createForOfIteratorHelper(match),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var item = _step.value;\n\n        if (item instanceof Object && item.name in cloneData) {\n          delete cloneData[item.name];\n        }\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n\n    url = domain + url;\n  } catch (e) {}\n\n  data = data ? data : {\n    path: \"\"\n  };\n  options.url = method.toLocaleLowerCase() === \"get\" ? data.path ? \"\".concat(url).concat(isEmpty(cloneData) ? \"\" : \"/\").concat(cloneData.path) : \"\".concat(url).concat(isEmpty(cloneData) ? \"\" : \"?\").concat(qs.stringify(cloneData)) : url;\n  if (method.toLocaleLowerCase() === \"delete\") options.url = method.toLocaleLowerCase() === \"delete\" ? \"\".concat(url).concat(isEmpty(cloneData) ? \"\" : \"/\").concat(cloneData.id) : url;\n  if (method.toLocaleLowerCase() === \"put\" && cloneData.path) options.url = \"\".concat(url).concat(isEmpty(cloneData) ? \"\" : \"/\").concat(cloneData.path);\n  if (method.toLocaleLowerCase() === \"patch\" && cloneData.path) options.url = \"\".concat(url).concat(isEmpty(cloneData) ? \"\" : \"/\").concat(cloneData.path);\n  options.cancelToken = new CancelToken(function (cancel) {\n    window.cancelRequest.set(Symbol(Date.now()), {\n      pathname: window.location.pathname,\n      cancel: cancel\n    });\n  });\n  axios.defaults.headers.common[\"Authorization\"] = localStorage.getItem(TOKEN_NAME);\n  axios.defaults.baseURL = \"http://localhost:5000\"; // axios.defaults.baseURL = \"https://ark-logistics.uz\";\n\n  try {\n    if (data.fileUpload) {\n      options.headers = {\n        \"Content-Type\": \"multipart/form-data\"\n      };\n      var formData = new FormData();\n\n      if (data.file.length > 1) {\n        Array.from(data.file).forEach(function (file, i) {\n          formData.append(file.name, file.file[0]);\n        });\n      } else {\n        formData.append(\"file\", data.file[0]);\n      }\n\n      delete data.file;\n      formData.append(\"type\", data.type);\n      Object.keys(data).forEach(function (i) {\n        return formData.append(i, data[i]);\n      });\n      options.data = formData;\n    }\n  } catch (e) {}\n\n  return axios(options).then(function (response) {\n    var statusText = response.statusText,\n        status = response.status,\n        data = response.data;\n    var result = {};\n\n    if (typeof data === \"object\") {\n      result = data;\n\n      if (Array.isArray(data)) {\n        result.list = data;\n      }\n    } else {\n      result.data = data;\n    }\n\n    return Promise.resolve(_objectSpread({\n      success: true,\n      message: statusText,\n      statusCode: status\n    }, result));\n  }).catch(function (error) {\n    var response = error.response;\n    var msg;\n    var statusCode;\n\n    if (response && response instanceof Object) {\n      var _data = response.data,\n          statusText = response.statusText;\n      statusCode = response.status;\n      msg = _data.message || statusText;\n    } else {\n      statusCode = 600;\n      msg = error.message || \"Network Error\";\n    }\n    /* eslint-disable */\n\n\n    return Promise.resolve({\n      success: false,\n      statusCode: statusCode,\n      message: msg\n    });\n  });\n}","map":{"version":3,"sources":["C:/Users/Ibrohim/Desktop/ark-front/src/util/request.js"],"names":["axios","cloneDeep","isEmpty","pathToRegexp","qs","TOKEN_NAME","CancelToken","window","cancelRequest","Map","request","options","data","url","method","cloneData","domain","urlMatch","match","slice","length","parse","compile","item","Object","name","e","path","toLocaleLowerCase","stringify","id","cancelToken","cancel","set","Symbol","Date","now","pathname","location","defaults","headers","common","localStorage","getItem","baseURL","fileUpload","formData","FormData","file","Array","from","forEach","i","append","type","keys","then","response","statusText","status","result","isArray","list","Promise","resolve","success","message","statusCode","catch","error","msg"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport { cloneDeep, isEmpty } from \"lodash\";\r\nimport pathToRegexp from \"path-to-regexp\";\r\nimport qs from \"qs\";\r\nimport { TOKEN_NAME } from \"./constants\";\r\n\r\nconst { CancelToken } = axios;\r\nwindow.cancelRequest = new Map();\r\n\r\nexport default function request(options) {\r\n  let { data, url, method = \"get\" } = options;\r\n  let cloneData = cloneDeep(data);\r\n  try {\r\n    let domain = \"\";\r\n    const urlMatch = url.match(/[a-zA-z]+:\\/\\/[^/]*/);\r\n    if (urlMatch) {\r\n      [domain] = urlMatch;\r\n      url = url.slice(domain.length);\r\n    }\r\n\r\n    const match = pathToRegexp.parse(url);\r\n    url = pathToRegexp.compile(url)(data);\r\n\r\n    for (const item of match) {\r\n      if (item instanceof Object && item.name in cloneData) {\r\n        delete cloneData[item.name];\r\n      }\r\n    }\r\n    url = domain + url;\r\n  } catch (e) {}\r\n  data = data ? data : { path: \"\" };\r\n  options.url =\r\n    method.toLocaleLowerCase() === \"get\"\r\n      ? data.path\r\n        ? `${url}${isEmpty(cloneData) ? \"\" : \"/\"}${cloneData.path}`\r\n        : `${url}${isEmpty(cloneData) ? \"\" : \"?\"}${qs.stringify(cloneData)}`\r\n      : url;\r\n  if (method.toLocaleLowerCase() === \"delete\")\r\n    options.url =\r\n      method.toLocaleLowerCase() === \"delete\"\r\n        ? `${url}${isEmpty(cloneData) ? \"\" : \"/\"}${cloneData.id}`\r\n        : url;\r\n  if (method.toLocaleLowerCase() === \"put\" && cloneData.path)\r\n    options.url = `${url}${isEmpty(cloneData) ? \"\" : \"/\"}${cloneData.path}`;\r\n  if (method.toLocaleLowerCase() === \"patch\" && cloneData.path)\r\n    options.url = `${url}${isEmpty(cloneData) ? \"\" : \"/\"}${cloneData.path}`;\r\n  options.cancelToken = new CancelToken((cancel) => {\r\n    window.cancelRequest.set(Symbol(Date.now()), {\r\n      pathname: window.location.pathname,\r\n      cancel,\r\n    });\r\n  });\r\n  axios.defaults.headers.common[\"Authorization\"] =\r\n    localStorage.getItem(TOKEN_NAME);\r\n  axios.defaults.baseURL = \"http://localhost:5000\";\r\n  // axios.defaults.baseURL = \"https://ark-logistics.uz\";\r\n  try {\r\n    if (data.fileUpload) {\r\n      options.headers = {\r\n        \"Content-Type\": \"multipart/form-data\",\r\n      };\r\n      const formData = new FormData();\r\n      if (data.file.length > 1) {\r\n        Array.from(data.file).forEach((file, i) => {\r\n          formData.append(file.name, file.file[0]);\r\n        });\r\n      } else {\r\n        formData.append(\"file\", data.file[0]);\r\n      }\r\n      delete data.file;\r\n      formData.append(\"type\", data.type);\r\n      Object.keys(data).forEach((i) => formData.append(i, data[i]));\r\n      options.data = formData;\r\n    }\r\n  } catch (e) {}\r\n  return axios(options)\r\n    .then((response) => {\r\n      const { statusText, status, data } = response;\r\n      let result = {};\r\n      if (typeof data === \"object\") {\r\n        result = data;\r\n        if (Array.isArray(data)) {\r\n          result.list = data;\r\n        }\r\n      } else {\r\n        result.data = data;\r\n      }\r\n      return Promise.resolve({\r\n        success: true,\r\n        message: statusText,\r\n        statusCode: status,\r\n        ...result,\r\n      });\r\n    })\r\n    .catch((error) => {\r\n      const { response } = error;\r\n      let msg;\r\n      let statusCode;\r\n      if (response && response instanceof Object) {\r\n        const { data, statusText } = response;\r\n        statusCode = response.status;\r\n        msg = data.message || statusText;\r\n      } else {\r\n        statusCode = 600;\r\n        msg = error.message || \"Network Error\";\r\n      }\r\n      /* eslint-disable */\r\n      return Promise.resolve({\r\n        success: false,\r\n        statusCode,\r\n        message: msg,\r\n      });\r\n    });\r\n}\r\n"]},"metadata":{},"sourceType":"module"}